<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consolidating inForm data • phenoptrReports</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Consolidating inForm data">
<meta property="og:description" content="phenoptrReports">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phenoptrReports</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/consolidation.html">Consolidating inForm data</a>
    </li>
    <li>
      <a href="../articles/analysis.html">Analyzing inForm data</a>
    </li>
    <li>
      <a href="../articles/spatial_map_viewer.html">Visualizing spatial relationships</a>
    </li>
    <li>
      <a href="../articles/unmixing_quality_report.html">Unmixing quality report</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="https://github.com/akoyabio/phenoptrReports">
    <span class="fas fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="consolidation_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Consolidating inForm data</h1>
                        <h4 class="author">Kent Johnson</h4>
            
            <h4 class="date">2021-06-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/akoyabio/phenoptrReports/blob/master/vignettes/consolidation.Rmd"><code>vignettes/consolidation.Rmd</code></a></small>
      <div class="hidden name"><code>consolidation.Rmd</code></div>

    </div>

    
    
<div id="data-consolidation-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#data-consolidation-overview" class="anchor"></a>Data consolidation overview</h2>
<p>The first step in a <code>phenoptrReports</code> data analysis is data consolidation.</p>
<p>The consolidation step combines the output from multiple inForm projects into a single consolidated data file and creates columns for each individual phenotype. The inputs to this step are merged cell seg data files from multiple inForm projects. The output is a consolidated data file and a summary report for each file.</p>
<p>NOTE: The consolidation step will fail if the Slide IDs and Cell IDs in the merge files do not exactly agree. This can happen, for example, if</p>
<ul>
<li>the projects use different cell segmentation parameters</li>
<li>different fields were included in the merge step</li>
<li>a region of interest or disinterest was drawn in the merge step</li>
</ul>
<p>Run the consolidation step even if your data comes from a single inForm project. This creates a data file in the format that the analysis step uses.</p>
</div>
<div id="data-requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#data-requirements" class="anchor"></a>Data requirements</h2>
<div id="merged-cell-seg-data" class="section level4">
<h4 class="hasAnchor">
<a href="#merged-cell-seg-data" class="anchor"></a>Merged cell seg data</h4>
<p>The primary source data for <code>phenoptrReports</code> is one or more merged cell seg data files created in the inForm Review/Merge tab. You may use multiple merge files from multiple inForm projects with different phenotypes. The Slide ID and Cell ID fields in multiple merge files must agree exactly.</p>
</div>
<div id="tissue-segmentation" class="section level4">
<h4 class="hasAnchor">
<a href="#tissue-segmentation" class="anchor"></a>Tissue segmentation</h4>
<p>inForm projects used with <code>phenoptrReports</code> must include a tissue segmentation step.</p>
</div>
<div id="phenotypes" class="section level4">
<h4 class="hasAnchor">
<a href="#phenotypes" class="anchor"></a>Phenotypes</h4>
<p>The names of positive phenotypes used with <code>phenoptrReports</code> must end with “+”, for example “CD8+” or “FoxP3+”. Negative and “Other” phenotype names should not end in “+”.</p>
</div>
</div>
<div id="detailed-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#detailed-steps" class="anchor"></a>Detailed steps</h2>
<div id="choose-consolidate-and-summarize-from-the-rstudio-addins-menu" class="section level4">
<h4 class="hasAnchor">
<a href="#choose-consolidate-and-summarize-from-the-rstudio-addins-menu" class="anchor"></a>Choose “Consolidate and summarize” from the RStudio Addins menu</h4>
<p>Thus will open the consolidation app.</p>
<p><img src="figures/Consolidate_addin.png"></p>
</div>
<div id="select-source-files" class="section level4">
<h4 class="hasAnchor">
<a href="#select-source-files" class="anchor"></a>Select source files</h4>
<p>Click the “Browse Input” button in the “Select source data files” section of the GUI. Use the file selection dialog to select your inForm merge data files. If the files are in multiple directories, click the Browse button multiple times to select them.</p>
<p><img src="figures/Select_merge_files.png"></p>
<p>Select “Keep only phenoptrReports fields” to reduce the size of the consolidated data file by omitting rarely used fields such as Min and Max expression and cell Compactness.</p>
</div>
<div id="select-output-directory" class="section level4">
<h4 class="hasAnchor">
<a href="#select-output-directory" class="anchor"></a>Select output directory</h4>
<p>Click the “Browse Output” button in the “Select output directory” section of the GUI. Use the directory selection dialog to create a new directory to contain the output files.</p>
<p><img src="figures/Select_output_directory.png"></p>
</div>
<div id="process-files" class="section level4">
<h4 class="hasAnchor">
<a href="#process-files" class="anchor"></a>Process files</h4>
<p>Click the “Process Files” button to start processing of the selected files.</p>
<p><img src="figures/Process_files.png"></p>
<p>A small progress meter will open to show progress. Any errors will be shown in the RStudio Console pane.</p>
<p><img src="figures/Processing_please_wait.png"></p>
</div>
<div id="view-summary-reports" class="section level4">
<h4 class="hasAnchor">
<a href="#view-summary-reports" class="anchor"></a>View summary reports</h4>
<p>When processing completes, the output directory will contain several files:</p>
<ul>
<li>
<code>Consolidated_data.txt</code> - A data file containing the consolidated results</li>
<li>
<code>Consolidated_data.html</code> - A report containing summary information about the consolidated data</li>
<li>Summary reports for each merge file that contributed to the result</li>
</ul>
<p>The consolidated data file is used for the actual analysis. The summary reports contain an overview of the data, including</p>
<ul>
<li>number of fields per slide</li>
<li>number of cells of each phenotype per slide</li>
<li>visualizations of the combination phenotypes present in the data</li>
</ul>
</div>
<div id="next-analysis" class="section level4">
<h4 class="hasAnchor">
<a href="#next-analysis" class="anchor"></a>Next: Analysis</h4>
<p>Continue to the <a href="analysis.html">next tutorial</a> to learn how to complete your analysis.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kent S Johnson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
